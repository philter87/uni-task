{
  "_comment": "Examples for GitHub Webhooks for Issues and Projects",
  "webhook_overview": {
    "description": "Webhooks allow you to subscribe to events on GitHub and receive HTTP POST payloads",
    "use_cases": [
      "Trigger CI/CD pipelines when issues are created",
      "Send notifications to Slack/Teams",
      "Update external ticket systems",
      "Synchronize project management tools",
      "Automate issue workflows"
    ],
    "payload_cap": "25 MB maximum",
    "delivery_timeout": "10 seconds"
  },
  "create_repository_webhook": {
    "description": "Create a webhook for a repository",
    "endpoint": "POST /repos/{owner}/{repo}/hooks",
    "method": "POST",
    "permissions_required": "Webhooks repository permissions (write)",
    "example_request": {
      "url": "https://api.github.com/repos/octocat/Hello-World/hooks",
      "headers": {
        "Accept": "application/vnd.github+json",
        "Authorization": "Bearer YOUR_TOKEN",
        "X-GitHub-Api-Version": "2022-11-28"
      },
      "body": {
        "name": "web",
        "active": true,
        "events": ["issues", "issue_comment", "pull_request"],
        "config": {
          "url": "https://example.com/webhook",
          "content_type": "json",
          "secret": "your-webhook-secret",
          "insecure_ssl": "0"
        }
      }
    },
    "curl_example": "curl -L -X POST -H \"Accept: application/vnd.github+json\" -H \"Authorization: Bearer YOUR_TOKEN\" -H \"X-GitHub-Api-Version: 2022-11-28\" https://api.github.com/repos/OWNER/REPO/hooks -d '{\"name\":\"web\",\"active\":true,\"events\":[\"issues\",\"pull_request\"],\"config\":{\"url\":\"https://example.com/webhook\",\"content_type\":\"json\"}}'",
    "response": {
      "status": 201,
      "body": {
        "type": "Repository",
        "id": 12345678,
        "name": "web",
        "active": true,
        "events": ["issues", "issue_comment"],
        "config": {
          "content_type": "json",
          "insecure_ssl": "0",
          "url": "https://example.com/webhook"
        },
        "url": "https://api.github.com/repos/octocat/Hello-World/hooks/12345678",
        "created_at": "2026-02-21T10:00:00Z",
        "updated_at": "2026-02-21T10:00:00Z"
      }
    }
  },
  "available_events": {
    "issues": {
      "description": "Issue activity (created, edited, closed, etc.)",
      "actions": [
        "assigned",
        "unassigned",
        "labeled",
        "unlabeled",
        "opened",
        "edited",
        "milestoned",
        "demilestoned",
        "closed",
        "reopened",
        "deleted",
        "transferred",
        "pinned",
        "unpinned",
        "locked",
        "unlocked"
      ],
      "availability": ["Repositories", "Organizations", "GitHub Apps"]
    },
    "issue_comment": {
      "description": "Issue or pull request comment activity",
      "actions": ["created", "edited", "deleted"],
      "availability": ["Repositories", "Organizations", "GitHub Apps"]
    },
    "label": {
      "description": "Label activity (created, edited, deleted)",
      "actions": ["created", "edited", "deleted"],
      "availability": ["Repositories", "Organizations", "GitHub Apps"]
    },
    "milestone": {
      "description": "Milestone activity",
      "actions": ["created", "closed", "opened", "edited", "deleted"],
      "availability": ["Repositories", "Organizations", "GitHub Apps"]
    },
    "project": {
      "description": "Classic project activity",
      "actions": ["created", "closed", "reopened", "edited", "deleted"],
      "availability": ["Repositories", "Organizations", "GitHub Apps"],
      "note": "For classic projects only"
    },
    "project_card": {
      "description": "Classic project card activity",
      "actions": ["created", "edited", "moved", "converted", "deleted"],
      "availability": ["Repositories", "Organizations", "GitHub Apps"]
    },
    "project_column": {
      "description": "Classic project column activity",
      "actions": ["created", "updated", "moved", "deleted"],
      "availability": ["Repositories", "Organizations", "GitHub Apps"]
    },
    "projects_v2": {
      "description": "Projects v2 activity",
      "actions": ["created", "edited", "closed", "reopened", "deleted"],
      "availability": ["Organizations"],
      "note": "For new Projects experience"
    },
    "projects_v2_item": {
      "description": "Projects v2 item activity",
      "actions": ["created", "edited", "deleted", "archived", "restored", "converted"],
      "availability": ["Organizations"]
    }
  },
  "webhook_payload_example": {
    "description": "Example webhook payload for issues event",
    "headers": {
      "X-GitHub-Event": "issues",
      "X-GitHub-Delivery": "72d3162e-cc78-11e3-81ab-4c9367dc0958",
      "X-Hub-Signature-256": "sha256=d57c68ca6f92289e6987922ff26938930f6e66a2d161ef06abdf1859230aa23c",
      "X-GitHub-Hook-ID": "292430182",
      "User-Agent": "GitHub-Hookshot/abc123",
      "Content-Type": "application/json"
    },
    "payload": {
      "action": "opened",
      "issue": {
        "url": "https://api.github.com/repos/octocat/Hello-World/issues/1347",
        "number": 1347,
        "title": "Found a bug",
        "body": "I'm having a problem with this.",
        "state": "open",
        "user": {
          "login": "octocat",
          "id": 1
        },
        "labels": [
          {
            "name": "bug",
            "color": "f29513"
          }
        ],
        "assignee": {
          "login": "octocat",
          "id": 1
        },
        "created_at": "2011-04-22T13:33:48Z",
        "updated_at": "2011-04-22T13:33:48Z"
      },
      "repository": {
        "id": 1296269,
        "name": "Hello-World",
        "full_name": "octocat/Hello-World",
        "owner": {
          "login": "octocat",
          "id": 1
        },
        "private": false
      },
      "sender": {
        "login": "octocat",
        "id": 1
      }
    }
  },
  "webhook_security": {
    "description": "Securing webhook deliveries",
    "secret_configuration": {
      "purpose": "Validate that payloads are from GitHub",
      "location": "Set when creating webhook in config.secret",
      "usage": "GitHub signs payloads with this secret"
    },
    "signature_validation": {
      "header": "X-Hub-Signature-256",
      "algorithm": "HMAC SHA-256",
      "format": "sha256=<hex_digest>",
      "validation_steps": [
        "1. Extract signature from X-Hub-Signature-256 header",
        "2. Compute HMAC SHA-256 of request body using your secret",
        "3. Compare computed signature with received signature",
        "4. Use constant-time comparison to prevent timing attacks"
      ]
    },
    "python_validation_example": "import hmac\nimport hashlib\n\ndef verify_signature(payload_body, secret_token, signature_header):\n    \"\"\"Verify webhook signature\"\"\"\n    hash_object = hmac.new(\n        secret_token.encode('utf-8'),\n        msg=payload_body,\n        digestmod=hashlib.sha256\n    )\n    expected_signature = 'sha256=' + hash_object.hexdigest()\n    return hmac.compare_digest(expected_signature, signature_header)",
    "nodejs_validation_example": "const crypto = require('crypto');\n\nfunction verifySignature(payload, secret, signature) {\n  const hmac = crypto.createHmac('sha256', secret);\n  const digest = 'sha256=' + hmac.update(payload).digest('hex');\n  return crypto.timingSafeEqual(\n    Buffer.from(signature),\n    Buffer.from(digest)\n  );\n}"
  },
  "webhook_server_example": {
    "description": "Simple webhook handler examples",
    "express_nodejs": "const express = require('express');\nconst crypto = require('crypto');\n\nconst app = express();\napp.use(express.json());\n\napp.post('/webhook', (req, res) => {\n  const signature = req.headers['x-hub-signature-256'];\n  const event = req.headers['x-github-event'];\n  const payload = req.body;\n\n  // Verify signature\n  if (!verifySignature(JSON.stringify(payload), SECRET, signature)) {\n    return res.status(401).send('Invalid signature');\n  }\n\n  // Handle different events\n  if (event === 'issues') {\n    if (payload.action === 'opened') {\n      console.log(`New issue #${payload.issue.number}: ${payload.issue.title}`);\n      // Your logic here\n    }\n  }\n\n  res.status(200).send('OK');\n});\n\napp.listen(3000);",
    "flask_python": "from flask import Flask, request, abort\nimport hmac\nimport hashlib\n\napp = Flask(__name__)\n\n@app.route('/webhook', methods=['POST'])\ndef webhook():\n    signature = request.headers.get('X-Hub-Signature-256')\n    event = request.headers.get('X-GitHub-Event')\n    \n    # Verify signature\n    if not verify_signature(request.data, SECRET, signature):\n        abort(401)\n    \n    payload = request.json\n    \n    # Handle issues event\n    if event == 'issues':\n        if payload['action'] == 'opened':\n            issue = payload['issue']\n            print(f\"New issue #{issue['number']}: {issue['title']}\")\n            # Your logic here\n    \n    return 'OK', 200\n\nif __name__ == '__main__':\n    app.run(port=3000)"
  },
  "managing_webhooks": {
    "list_webhooks": {
      "endpoint": "GET /repos/{owner}/{repo}/hooks",
      "description": "List all webhooks for a repository"
    },
    "get_webhook": {
      "endpoint": "GET /repos/{owner}/{repo}/hooks/{hook_id}",
      "description": "Get details of a specific webhook"
    },
    "update_webhook": {
      "endpoint": "PATCH /repos/{owner}/{repo}/hooks/{hook_id}",
      "description": "Update webhook configuration",
      "example_body": {
        "active": true,
        "events": ["issues", "pull_request"],
        "config": {
          "url": "https://example.com/new-webhook-url"
        }
      }
    },
    "delete_webhook": {
      "endpoint": "DELETE /repos/{owner}/{repo}/hooks/{hook_id}",
      "description": "Delete a webhook"
    },
    "test_webhook": {
      "endpoint": "POST /repos/{owner}/{repo}/hooks/{hook_id}/tests",
      "description": "Trigger a test push event"
    },
    "ping_webhook": {
      "endpoint": "POST /repos/{owner}/{repo}/hooks/{hook_id}/pings",
      "description": "Trigger a ping event to test webhook"
    }
  },
  "webhook_deliveries": {
    "description": "View and manage webhook deliveries",
    "list_deliveries": {
      "endpoint": "GET /repos/{owner}/{repo}/hooks/{hook_id}/deliveries",
      "description": "List recent webhook deliveries (last 30 days)",
      "response_example": [
        {
          "id": 12345678,
          "guid": "0b989ba4-242f-11e5-81e1-c7b6966d2516",
          "delivered_at": "2026-02-21T10:00:00Z",
          "redelivery": false,
          "duration": 0.27,
          "status": "OK",
          "status_code": 200,
          "event": "issues",
          "action": "opened"
        }
      ]
    },
    "get_delivery": {
      "endpoint": "GET /repos/{owner}/{repo}/hooks/{hook_id}/deliveries/{delivery_id}",
      "description": "Get details of a specific delivery including request and response"
    },
    "redeliver": {
      "endpoint": "POST /repos/{owner}/{repo}/hooks/{hook_id}/deliveries/{delivery_id}/attempts",
      "description": "Redeliver a failed webhook delivery"
    }
  },
  "projects_v2_webhook_example": {
    "description": "Example for Projects v2 item webhook (organization-level)",
    "note": "Projects v2 webhooks are only available at organization level",
    "create_org_webhook": {
      "endpoint": "POST /orgs/{org}/hooks",
      "body": {
        "name": "web",
        "active": true,
        "events": ["projects_v2", "projects_v2_item"],
        "config": {
          "url": "https://example.com/webhook",
          "content_type": "json"
        }
      }
    },
    "payload_example": {
      "action": "created",
      "projects_v2_item": {
        "id": "PVTI_lADOANN5s84ACbL0zgBZrp4",
        "node_id": "PVTI_lADOANN5s84ACbL0zgBZrp4",
        "project_node_id": "PVT_kwDOANN5s84ACbL0",
        "content_node_id": "I_kwDOANN5s85cKLRo",
        "content_type": "Issue",
        "creator": {
          "login": "octocat"
        }
      },
      "organization": {
        "login": "my-org",
        "id": 123
      },
      "sender": {
        "login": "octocat"
      }
    }
  },
  "best_practices": {
    "security": [
      "Always validate webhook signatures",
      "Use HTTPS for payload URL",
      "Store webhook secret securely (environment variables)",
      "Implement rate limiting on webhook endpoint",
      "Log webhook deliveries for debugging"
    ],
    "reliability": [
      "Return 2xx status code quickly (< 10 seconds)",
      "Process payloads asynchronously (use queue)",
      "Handle duplicate deliveries idempotently",
      "Implement retry logic for failed processing",
      "Monitor webhook delivery failures"
    ],
    "performance": [
      "Respond to webhook immediately, process later",
      "Use job queues (Redis, RabbitMQ) for async processing",
      "Don't perform long-running operations in webhook handler",
      "Cache frequently accessed data"
    ],
    "testing": [
      "Use GitHub's webhook testing feature",
      "Set up ngrok or similar for local development",
      "Test with all relevant event types",
      "Verify signature validation works",
      "Test failure scenarios"
    ]
  },
  "troubleshooting": {
    "common_issues": {
      "timeout": {
        "problem": "Webhook times out after 10 seconds",
        "solution": "Return 200 immediately, process asynchronously"
      },
      "invalid_signature": {
        "problem": "Signature validation fails",
        "solutions": [
          "Verify secret matches webhook configuration",
          "Use raw request body, not parsed JSON",
          "Check for extra whitespace or encoding issues",
          "Ensure using constant-time comparison"
        ]
      },
      "missing_events": {
        "problem": "Not receiving expected webhooks",
        "solutions": [
          "Check webhook is active",
          "Verify events are selected in configuration",
          "Check Recent Deliveries in webhook settings",
          "Ensure endpoint is publicly accessible"
        ]
      },
      "duplicate_deliveries": {
        "problem": "Receiving same webhook multiple times",
        "solution": "Implement idempotency using delivery ID"
      }
    },
    "debugging_tools": {
      "github_ui": "Check Recent Deliveries in repository/org webhook settings",
      "request_logs": "View full request and response in delivery details",
      "webhook_proxy": "Use webhook.site or similar for testing",
      "local_testing": "Use ngrok or GitHub CLI to forward webhooks locally"
    }
  },
  "rate_limits": {
    "webhook_creation": "Limited by API rate limits (5000/hour)",
    "deliveries": "No specific limit, but excessive failures may disable webhook",
    "redeliveries": "Manual redeliveries are rate limited"
  }
}
